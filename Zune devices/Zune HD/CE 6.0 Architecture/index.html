<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://zunedev.github.io/Zune%20devices/Zune%20HD/CE%206.0%20Architecture/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>CE 6.0 Architecture - ZuneDev Wiki</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../assets/mkdocs_pagetree_plugin.css" rel="stylesheet">
        <link href="../../../style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">ZuneDev Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Welcome</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Atlas</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Atlas/" class="dropdown-item">Atlas</a>
</li>
                                    
<li>
    <a href="../../../Atlas/File%20Types/" class="dropdown-item">File Types</a>
</li>
                                    
<li>
    <a href="../../../Atlas/Official%20Documentation/" class="dropdown-item">Official Documentation</a>
</li>
                                    
<li>
    <a href="../../../Atlas/Paths/" class="dropdown-item">Paths</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Zune devices</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Firmware%20Files/" class="dropdown-item">Firmware Files</a>
</li>
                                    
<li>
    <a href="../../Gem%20Files/" class="dropdown-item">Gem Files</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Apps</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/Activating%20Visual%20Studio%202008%20Profressional/" class="dropdown-item">Activating VS 2008 Professional</a>
</li>
            
<li>
    <a href="../../Apps/Keep%20WIFI%20Enabled/" class="dropdown-item">Keep WIFI Enabled</a>
</li>
            
<li>
    <a href="../../Apps/ZCP%20Files/" class="dropdown-item">ZCP Files</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">OpenZDK</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/OpenZDK/" class="dropdown-item">OpenZDK</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Liberate/" class="dropdown-item">Liberate</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Reference/" class="dropdown-item">Open ZDK Reference</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Setup/" class="dropdown-item">Setup</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Headers</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/OpenZDK/Headers/ZDKSystem_ShowSplashScreen/" class="dropdown-item">ZDKSystem_ShowSplashScreen(int flag)</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkaudio.h/" class="dropdown-item">zdkaudio.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkcontent.h/" class="dropdown-item">zdkcontent.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkdisplay.h/" class="dropdown-item">zdkdisplay.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkfont.h/" class="dropdown-item">zdkfont.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkimage.h/" class="dropdown-item">zdkimage.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkinput.h/" class="dropdown-item">zdkinput.h</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XNA Framework</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/XNA%20Framework/" class="dropdown-item">XNA Framework</a>
</li>
            
<li>
    <a href="../../Apps/XNA%20Framework/XNA%20Apps/" class="dropdown-item">XNA Apps</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Zune HD</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../" class="dropdown-item">Zune HD</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">CE 6.0 Architecture</a>
</li>
            
<li>
    <a href="../Device%20Manager/" class="dropdown-item">Device Manger</a>
</li>
            
<li>
    <a href="../Exploits/" class="dropdown-item">Exploits</a>
</li>
            
<li>
    <a href="../Fusee%20Gelee/" class="dropdown-item">Fusee Gelee</a>
</li>
            
<li>
    <a href="../OpenGL%20ES/" class="dropdown-item">OpenGL ES</a>
</li>
            
<li>
    <a href="../Partitions%20and%20Filesystems/" class="dropdown-item">Partitions and Filesystems</a>
</li>
            
<li>
    <a href="../Windows%20CE%206.0/" class="dropdown-item">Windows CE 6.0</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Zune software</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Zune%20software/" class="dropdown-item">Zune software</a>
</li>
                                    
<li>
    <a href="../../../Zune%20software/radio/" class="dropdown-item">Radio</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Iris</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Zune%20software/Iris/" class="dropdown-item">Microsoft Iris</a>
</li>
            
<li>
    <a href="../../../Zune%20software/Iris/compiled-uix/" class="dropdown-item">Compiled UIX v4</a>
</li>
            
<li>
    <a href="../../../Zune%20software/Iris/uix-assembly/" class="dropdown-item">UIX Assembly</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Device%20Manager/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ZuneDev/Wiki/blob/main/docs/Zune devices/Zune HD/CE 6.0 Architecture.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#ce-60-architecture" class="nav-link">CE 6.0 Architecture</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#system-filescomponents" class="nav-link">System Files/Components</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#security" class="nav-link">Security</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#gwes" class="nav-link">GWES</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#memory-layout" class="nav-link">Memory Layout</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#references" class="nav-link">References</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="ce-60-architecture">CE 6.0 Architecture</h1>
<p><img alt="Diagram of the architecture of Windows CE 6.0" src="../../../img/SystemArchitectureDiagram.gif" /></p>
<h2 id="system-filescomponents">System Files/Components</h2>
<h3 id="kxxxdll">K.xxx.DLL</h3>
<p>These DLLs reflect the same DLLs without the K in front of it, but live in Kernel space. This way when porting old drivers from Windows CE 5.0 (where all drivers lived in user mode) the code can simply call the same API, but it does not need to perform a context switch. User mode calls are handled by <code>Coredll.dll</code> and calls from processes running in kernel mode are redirected to <code>Kernel.DLL</code> by <code>K.Coredll.DLL</code> so that the call stays in the same VM. This way the calls are way faster compared to Windows CE 5.0.</p>
<p>Any DLL that is use by both kernel-mode and user-mode processes will be loaded as both kernel-mode and user-mode.</p>
<h3 id="services">Services</h3>
<p>Services run in user-mode and are handled by the <code>Services Manager</code>.</p>
<h3 id="device-manager">Device Manager</h3>
<p>The <a href="../Device%20Manager/"><code>Device.DLL</code></a> runs in kernel-mode and loads the device drivers. It supports loading drivers on boot or on demand. Windows also provides a user-mode Device Manager for drivers installed after shipping for example.</p>
<h3 id="nkexe">NK.EXE</h3>
<p>This used to be the kernel, but now it just contains a thin abstraction layer and compatibility layer, provided by the OEM. The actual Kernel now lives in <code>Kernel.DLL</code>.</p>
<h2 id="security">Security</h2>
<p>Windows CE 6.0 removed both the "all kernel mode" (running everything in kernel mode) feature and the trusted model (trusted and untrusted .EXEs and DLLs). It also does not have the Access Control List of newer desktop systems.</p>
<p>The system also provides a separate handle table for each process.</p>
<h2 id="gwes">GWES</h2>
<p>GWES provides graphical functionality.</p>
<h2 id="memory-layout">Memory Layout</h2>
<p><a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/ee483001(v=winembedded.60)">Microsoft - Memory Layout</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/bb331824(v=msdn.10)">Microsoft - Windows Embedded CE 6.0 Advanced Memory Management</a></li>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/ee504804(v=winembedded.60)">Microsoft - Windows Embedded CE Architecture</a></li>
</ul>
<hr />
<p><a href="../Windows%20CE%206.0/">🗺️ Windows CE 6.0</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../assets/mkdocs_pagetree_plugin.js"></script>
        <script src="../../../javascripts/mathjax.js"></script>
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
