<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://zunedev.github.io/Zune%20devices/Zune%20HD/Exploits/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Exploits - ZuneDev Wiki</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../assets/mkdocs_pagetree_plugin.css" rel="stylesheet">
        <link href="../../../style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">ZuneDev Wiki</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Welcome</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Atlas</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Atlas/" class="dropdown-item">Atlas</a>
</li>
                                    
<li>
    <a href="../../../Atlas/File%20Types/" class="dropdown-item">File Types</a>
</li>
                                    
<li>
    <a href="../../../Atlas/Official%20Documentation/" class="dropdown-item">Official Documentation</a>
</li>
                                    
<li>
    <a href="../../../Atlas/Paths/" class="dropdown-item">Paths</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Zune devices</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Firmware%20Files/" class="dropdown-item">Firmware Files</a>
</li>
                                    
<li>
    <a href="../../Gem%20Files/" class="dropdown-item">Gem Files</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Apps</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/Activating%20Visual%20Studio%202008%20Profressional/" class="dropdown-item">Activating VS 2008 Professional</a>
</li>
            
<li>
    <a href="../../Apps/Keep%20WIFI%20Enabled/" class="dropdown-item">Keep WIFI Enabled</a>
</li>
            
<li>
    <a href="../../Apps/ZCP%20Files/" class="dropdown-item">ZCP Files</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">OpenZDK</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/OpenZDK/" class="dropdown-item">OpenZDK</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Liberate/" class="dropdown-item">Liberate</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Reference/" class="dropdown-item">Open ZDK Reference</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Setup/" class="dropdown-item">Setup</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Headers</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/OpenZDK/Headers/ZDKSystem_ShowSplashScreen/" class="dropdown-item">ZDKSystem_ShowSplashScreen(int flag)</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkaudio.h/" class="dropdown-item">zdkaudio.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkcontent.h/" class="dropdown-item">zdkcontent.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkdisplay.h/" class="dropdown-item">zdkdisplay.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkfont.h/" class="dropdown-item">zdkfont.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkimage.h/" class="dropdown-item">zdkimage.h</a>
</li>
            
<li>
    <a href="../../Apps/OpenZDK/Headers/zdkinput.h/" class="dropdown-item">zdkinput.h</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">XNA Framework</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Apps/XNA%20Framework/" class="dropdown-item">XNA Framework</a>
</li>
            
<li>
    <a href="../../Apps/XNA%20Framework/XNA%20Apps/" class="dropdown-item">XNA Apps</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Zune HD</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../" class="dropdown-item">Zune HD</a>
</li>
            
<li>
    <a href="../CE%206.0%20Architecture/" class="dropdown-item">CE 6.0 Architecture</a>
</li>
            
<li>
    <a href="../Device%20Manager/" class="dropdown-item">Device Manger</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Exploits</a>
</li>
            
<li>
    <a href="../Fusee%20Gelee/" class="dropdown-item">Fusee Gelee</a>
</li>
            
<li>
    <a href="../OpenGL%20ES/" class="dropdown-item">OpenGL ES</a>
</li>
            
<li>
    <a href="../Partitions%20and%20Filesystems/" class="dropdown-item">Partitions and Filesystems</a>
</li>
            
<li>
    <a href="../Windows%20CE%206.0/" class="dropdown-item">Windows CE 6.0</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Zune software</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../Zune%20software/" class="dropdown-item">Zune software</a>
</li>
                                    
<li>
    <a href="../../../Zune%20software/radio/" class="dropdown-item">Radio</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Iris</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Zune%20software/Iris/" class="dropdown-item">Microsoft Iris</a>
</li>
            
<li>
    <a href="../../../Zune%20software/Iris/compiled-uix/" class="dropdown-item">Compiled UIX v4</a>
</li>
            
<li>
    <a href="../../../Zune%20software/Iris/uix-assembly/" class="dropdown-item">UIX Assembly</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Device%20Manager/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Fusee%20Gelee/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ZuneDev/Wiki/blob/main/docs/Zune devices/Zune HD/Exploits.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#exploits" class="nav-link">Exploits</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#openzdk" class="nav-link">OpenZDK</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#zuneslayer" class="nav-link">Zuneslayer</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#fusee-gelee" class="nav-link">Fusée Gelée</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="exploits">Exploits</h1>
<p>There are a few known exploits for the Zune HD, each with varying capabilities. So far, no exploits have been discovered that allow for custom firmware or persistent modifications.</p>
<h2 id="openzdk">OpenZDK</h2>
<p><a href="../../Apps/OpenZDK/">OpenZDK</a> contains the earliest known exploit for the Zune, leveraging a bug in the shell to obtain arbitrary code execution within the app sandbox. This allows for the development of Zune apps that are not limited by XNA Framework or .NET Compact Framework 3.5.</p>
<h2 id="zuneslayer">Zuneslayer</h2>
<p><a href="https://github.com/CUB3D/zuneslayer/">Zuneslayer</a> by Argonaut <a href="https://github.com/CUB3D">CUB3D</a> is a suite of exploits for various Zune models, two of which target the HD.</p>
<h3 id="kernel">Kernel</h3>
<p>This is an exploit for firmware 4.5 built on <a href="../../Apps/OpenZDK/">OpenZDK</a> to gain native code execution at the kernel level. It cannot be used to dump the full bootROM. When launched using the typical <a href="../../Apps/XNA%20Framework/">XNA</a> loader, it cannot be used to read encrypted apps or DRM-protected media. </p>
<h3 id="browser">Browser</h3>
<p>This is an exploit of the Zune's JScript engine based on <a href="https://googleprojectzero.github.io/0days-in-the-wild//0day-RCAs/2019/CVE-2019-1367.html">CVE-2019-1367</a>. It can be used to launch other programs from outside the <a href="../../Apps/XNA%20Framework/XNA%20Apps/">app sandbox</a> and is a suitable alternative to the offical XNA loader. Programs launched using this technique can read encrypted apps and DRM-protected media.</p>
<p>The exploit by default loads whatever file is located at <code>\\Flash2\payload.exe</code>. Typically, the <code>\\Flash2</code> directory is inaccessible, but the <a href="#kernel">Zuneslayer kernel exploit</a> provides suffcient permissions to write files there. The browser exploit can be chained with kernel exploit as follows:</p>
<ol>
<li>Use the <a href="https://github.com/CUB3D/zuneslayer/tree/master/ZuneHD/zuneslayer_kernel/template"><code>zuneslayer_kernel</code> template</a> to create the payload you wish to run with kernel permissions.</li>
<li>Install the kernel exploit app as you would any other <a href="../../Apps/OpenZDK/">OpenZDK</a> app.</li>
<li>Open the kernel exploit app. If you used the template, it will automatically copy <code>nativeapp</code> to <code>\\Flash2\payload.exe</code>.</li>
<li>Serve <code>index.html</code> on a machine accessible from the Zune HD. For example, running an Apache web server on a machine in the same local network.</li>
<li>Visit the hosted page from the Zune HD browser and follow the on-screen instructions.</li>
<li>For applications that require reading DRM-protected content, the Zune must be restarted before the required permissions are granted.</li>
</ol>
<h2 id="fusee-gelee">Fusée Gelée</h2>
<p>It is believed that the Tegra APX 2600 used in the Zune HD is vulnerable to an attack similar to CVE-2018-6242, also known as <a href="../Fusee%20Gelee/">Fusée Gelée</a>. Theoretically, an attacker with physical access to a Zune in Tegra Recovery Mode (RCM) could execute arbitrary code as the root of trust.</p>
<p>This exploit has yet to be carried out on a Zune, since getting an HD into RCM is tricky. Any of the following conditions may trigger RCM as observed on other Tegra processors<a href="../Fusee%20Gelee/#vulnerability-details">¹</a>:</p>
<ol>
<li>If the processor fails to find a valid Boot Control Table (BCT) + bootloader on its boot media</li>
<li>If processor straps are pulled to a particular value e.g. by holding a button combination</li>
<li>If the processor is rebooted after a particular value is written into a power management controller scratch register.</li>
</ol>
<p>One Argonaut was able to intentionally enter RCM by desoldering the bootROM flash chip, which triggers the third condition. Other users during Zune's lifetime reported their HDs suddenly entering RCM and appearing to Windows as "APX"<a href="https://learn.microsoft.com/en-us/answers/questions/2504208/looking-for-apx-drivers">²</a>, though no cause is known.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../assets/mkdocs_pagetree_plugin.js"></script>
        <script src="../../../javascripts/mathjax.js"></script>
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
